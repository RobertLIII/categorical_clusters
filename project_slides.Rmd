---
title: "Cluster Analysis of Categorical Data"
author: "Xiaoyi Ma and Robert Long"
date: "4/14/2021"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r basic, include=F}
# use this function to conveniently load libraries and work smoothly with knitting
# can add quietly=T option to the require() function
loadPkg = function(pkg, character.only = FALSE) { 
  if (!character.only) { pkg <- as.character(substitute(pkg)) }
  pkg <- ifelse(!character.only, as.character(substitute(pkg)) , pkg)  
  if (!require(pkg,character.only=T, quietly =T)) {  install.packages(substitute(pkg),dep=T); if(!require(pkg,character.only=T)) stop("Package not found") } 
}
loadPkg(knitr)

# unload/detact package when done using it
unloadPkg = function(pkg, character.only = FALSE) { 
  if(!character.only) { pkg <- as.character(substitute(pkg)) } 
  search_item <- paste("package", pkg,sep = ":") 
  while(search_item %in% search()) { detach(search_item, unload = TRUE, character.only = TRUE) } 
}
```


```{r load_libraries, include=F}
set.seed(17)

loadPkg("MASS")
loadPkg("klaR")
loadPkg("cba")
loadPkg("factoextra")
loadPkg("cluster")
```

# Previously...
- Clusters clearly defined (subject $i$)
- Explanatory vs outcome also clearly defined
- Euclidean distances mostly make sense


# Now...
- Identify the clusters
  - $k$ clusters
  - The data decides
- Explanatory vs outcome not necessarily clear
- Difference measurements between categorical variables (dummy variables)
  - $p$ binary variables
  
 
 
```{r load_data}
data <- read.csv("mushrooms.csv")

data[sapply(data, is.character)] <- lapply(data[sapply(data, is.character)], as.factor)

str(data)

x.data <- subset(data, select=-c(veil.type, class))
```
 

# Dissimilarity Matrix

```{r dissim}
data.dist <- daisy(x.data, metric="gower")

fviz_dist(data.dist, 
   gradient=list(low = "steelblue",  high = "white"),
   order=T, show_labels=F)
```

# k-means Clustering

```{r kmeans}
data.matrix <- model.matrix(~.-1, data=x.data)

result.kmean = kmeans(data.matrix, 2, nstart = 50, iter.max = 15) 

result.kmean.mm <- table(data$class, result.kmean$cluster)
purity.kmean <- sum(apply(result.kmean.mm, 2, max)) / nrow(x.data)
purity.kmean

```


# New slide

# Code Chunk - New Slide
```{r code_chunk, results='markup'}
# write function/R code here
# code_chunk is a unique name for the code_chunk; so change it to make clear like a comment
# if you do not want the results posted onto a slide, change to results="hide"
# in-text code can be written like `r function()` using the function name instead of function()
```



```{r unload_libraries, include=F}
unloadPkg(MASS)
unloadPkg(klaR)
unloadPkg(cba)
unloadPkg(factoextra)
unloadPkg(cluster)
```

